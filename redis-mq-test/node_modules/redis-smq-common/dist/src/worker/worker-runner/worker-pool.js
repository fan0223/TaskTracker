"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.WorkerPool = void 0;
const async_1 = require("../../async/async");
class WorkerPool {
    constructor() {
        this.pool = [];
        this.work = (cb) => {
            if (this.pool.length) {
                const tasks = this.pool.map((worker) => (cb) => worker.work(cb));
                async_1.async.waterfall(tasks, cb);
            }
            else
                cb();
        };
        this.add = (worker) => {
            this.pool.push(worker);
            return this.pool.length;
        };
        this.clear = (cb) => {
            async_1.async.each(this.pool, (worker, _, done) => {
                worker.quit(done);
            }, () => {
                this.pool = [];
                cb();
            });
        };
    }
}
exports.WorkerPool = WorkerPool;
//# sourceMappingURL=worker-pool.js.map